<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panchayat – Dashboard</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
:root {
  --bg-gradient: linear-gradient(135deg,#0a0d14,#121722,#1c2433);
  --glass-bg: rgba(255,255,255,0.07);
  --card-border: rgba(255,255,255,0.15);
  --blur: 14px;

  --neon-blue: #3e8cff;
  --neon-purple: #b36bff;

  --text-title: #ffffff;
  --text-secondary: #c7c7c7;

  --shadow-glow: 0 0 18px rgba(62,140,255,0.45);
  --card-shadow: 0 0 20px rgba(0,0,0,0.35);
}

* { box-sizing: border-box; margin:0; padding:0; font-family:'Nunito',sans-serif; }

body {
  background: var(--bg-gradient);
  color: var(--text-secondary);
  min-height: 100vh;
}

/* HEADER */
.header{
  position: fixed;
  top:0; left:0;
  width:100%; height:80px;
  display:flex; align-items:center; gap:15px; padding:0 20px;
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur));
  border-bottom: 2px solid var(--card-border);
  box-shadow: var(--card-shadow);
  z-index:999;
}
.header-logo{ height:50px; width:auto; object-fit:contain; }
.header-title{
  font-size:22px; font-weight:800;
  background: linear-gradient(90deg,var(--neon-blue),var(--neon-purple));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* DASHBOARD CONTENT */
.desktop-wrapper{
  max-width:1100px;
  margin:120px auto 40px;
  padding:0 15px;
}
.section-title{
  font-size:22px;
  font-weight:800;
  margin:25px 0 15px;
  background: linear-gradient(90deg,var(--neon-blue),var(--neon-purple));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* BUTTON GRID */
.button-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:15px; }
.desk-btn{
  background: var(--glass-bg);
  padding:18px 0;
  text-align:center;
  border-radius:18px;
  font-size:18px; font-weight:700;
  color: var(--neon-blue);
  text-decoration:none;
  backdrop-filter: blur(var(--blur));
  border:2px solid var(--card-border);
  box-shadow: var(--card-shadow);
  transition:0.3s ease;
  cursor:pointer;
}
.desk-btn:hover{
  transform: translateY(-5px);
  border-color: var(--neon-blue);
  box-shadow: 0 0 20px var(--neon-blue);
  background: rgba(255,255,255,0.1);
}

/* COUNTER BOXES */
.counter-row{ display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:15px; margin-bottom:20px; }
.counter-box{
  background: var(--glass-bg);
  border-radius:18px;
  padding:22px;
  border:2px solid var(--card-border);
  backdrop-filter: blur(var(--blur));
  box-shadow: var(--card-shadow);
  transition:0.3s ease;
}
.counter-box:hover{
  transform: translateY(-4px);
  border-color: var(--neon-purple);
  box-shadow: 0 0 20px var(--neon-purple);
}
.counter-title{ font-size:17px; font-weight:700; margin-bottom:8px; color:var(--neon-blue); }
.count-number{ font-size:36px; font-weight:900; color:var(--text-title); }

/* MODALS */
.modal-bg{
  position: fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  display:none; justify-content:center; align-items:center;
  z-index:1000; padding:20px;
}
.modal-content{
  background: var(--glass-bg);
  padding:25px 30px; border-radius:18px; border:2px solid var(--card-border);
  backdrop-filter: blur(var(--blur));
  max-width:600px; width:90%; max-height:90vh; overflow-y:auto;
  box-shadow: var(--card-shadow);
  position: relative;
  transition:0.3s ease;
}
.modal-content:hover{
  box-shadow: 0 0 25px var(--neon-blue);
}
.close-btn{
  position:absolute; top:15px; right:15px;
  font-size:22px; font-weight:bold; cursor:pointer; color: var(--neon-blue);
}

/* FORM INSIDE MODAL */
form{ display:grid; grid-template-columns:1fr 1fr; gap:20px 20px; }
form label{ display:block; margin-bottom:6px; font-weight:600; color:var(--text-title); }
form input, form textarea, form select{
  width:100%; padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.2);
  font-size:14px; outline:none; background: rgba(255,255,255,0.05); color: var(--text-title);
  transition:0.3s;
}
form input:focus, form textarea:focus, form select:focus{
  border-color: var(--neon-blue);
  box-shadow:0 0 8px rgba(62,140,255,0.45);
}
.full-width{ grid-column:1 / -1; }
.checkbox-group{ display:flex; flex-wrap:wrap; gap:15px; }
.checkbox-item{ display:flex; align-items:center; gap:6px; font-size:14px; color: var(--text-secondary); }
.checkbox-item input[type="text"]{ flex:1; padding:5px 6px; border-radius:6px; border:1px solid rgba(255,255,255,0.2); margin-left:4px; background: rgba(255,255,255,0.05); color: var(--text-title); }

.submit-btn{
  grid-column:1 / -1; padding:14px; font-size:16px; font-weight:700;
  border-radius:50px; border:none; cursor:pointer;
  background: linear-gradient(135deg,var(--neon-blue),var(--neon-purple));
  color:#fff; transition:0.3s;
  margin-top:10px;
}
.submit-btn:hover{ transform: translateY(-3px); box-shadow: 0 0 18px var(--neon-blue); }

/* RESPONSIVE */
@media(max-width:600px){
  .desk-btn{ font-size:16px; padding:15px 0; }
  form{ grid-template-columns:1fr; }
}
</style>

</head>
<body>

  <div class="header">
    <img src="{% static 'image/logo.png' %}" alt="Logo" class="header-logo">
    <div class="header-title">Panchayat – Dashboard</div>
  </div>

  <div class="desktop-wrapper">

    <div class="section-title">Main Actions</div>
    <div class="button-grid">
      <a class="desk-btn">Notifications</a>
      <a href="javascript:void(0);" class="desk-btn" onclick="openComplaintModal()">Complaints</a>
      <a href="javascript:void(0);" class="desk-btn" onclick="openRequestModal()">Requests</a>
    </div>

    <div class="section-title">Your Records</div>
    <div class="counter-row">
      <div class="counter-box">
        <div class="counter-title">Total Complaints</div>
        <div class="count-number">{{ total_complaints }}</div>
      </div>
      <div class="counter-box">
        <div class="counter-title">Total Requests</div>
        <div class="count-number">{{ total_requests }}</div>
      </div>
    </div>

  </div>

  <!-- Complaint Modal -->
  <div class="modal-bg" id="complaintModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeComplaintModal()">&times;</span>
      <h2 style="margin-bottom:15px; color:#4f5dff;">Submit Complaint</h2>
      <form method="POST" enctype="multipart/form-data" action="{% url 'complaint_form' %}">
        {% csrf_token %}
        <div>
          <label for="user">Name:</label>
          <input type="text" name="user" id="user" required>
        </div>
        <div>
          <label for="phone">Phone / Email:</label>
          <input type="text" name="phone" id="phone" required>
        </div>
        <div class="full-width">
          <label for="address">Address:</label>
          <textarea name="address" id="address" rows="2" required></textarea>
        </div>
        <div>
  <div>
  <label for="areaDropdown">Area Name:</label>
<select name="area_name" id="areaDropdown" required>
  <option value="">-- Select Area --</option>
  {% for area in areas %}
    <option value="{{ area.name }}">{{ area.name }}</option>
  {% endfor %}
</select>
</div>
</div>
        <div>
    <!-- Optional: dynamically populate from Django
    {% for s in supervisors %}
        <option value="{{ s.area_name }}">{{ s.area_name }}</option>
    {% endfor %} -->
  </select>
</div>

        <div class="full-width">
          <label>Complaint Type:</label>
          <div class="checkbox-group">
            <label class="checkbox-item"><input type="checkbox" name="complaintType" value="Public Safety"> Public Safety</label>
            <label class="checkbox-item"><input type="checkbox" name="complaintType" value="Sanitation / Hygiene"> Sanitation / Hygiene</label>
            <label class="checkbox-item"><input type="checkbox" name="complaintType" value="Road / Traffic Issues"> Road / Traffic Issues</label>
            <label class="checkbox-item"><input type="checkbox" name="complaintType" value="Electricity / Water Supply"> Electricity / Water Supply</label>
            <label class="checkbox-item"><input type="checkbox" name="complaintType" value="Government Services"> Government Services</label>
            <label class="checkbox-item"><input type="checkbox" name="complaintType" value="Others"> Others:
              <input type="text" name="otherType" placeholder="Specify here">
            </label>
          </div>
        </div>
        <div>
          <label for="location">Location of Issue:</label>
          <input type="text" name="location" id="location" required>
        </div>
        <div>
          <label for="datetime">Date & Time:</label>
          <input type="datetime-local" name="datetime" id="datetime" required>
        </div>
        <div class="full-width">
          <label for="description">Description:</label>
          <textarea name="description" id="description" rows="4" required></textarea>
        </div>
        <div class="full-width">
          <label for="file">Attach File:</label>
          <input type="file" name="file" id="file">
        </div>

        <button type="submit" class="submit-btn">Submit Complaint</button>
      </form>
    </div>
  </div>

  <!-- Request Modal -->
  <div class="modal-bg" id="requestModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeRequestModal()">&times;</span>
      <h2 style="margin-bottom:15px; color:#4f5dff;">Submit Request</h2>

      <form method="POST" action="{% url 'requestform' %}">
        {% csrf_token %}

        <!-- Name -->
        <div>
          <label for="name">Name:</label>
          <input type="text" name="name" id="name" required>
        </div>

        <!-- Phone -->
        <div>
          <label for="phone">Phone Number:</label>
          <input type="text" name="phone" id="phone" required>
        </div>

        <!-- Address (You removed this by mistake — Added back) -->
        <div class="full-width">
          <label for="address">Address:</label>
          <textarea name="address" id="address" rows="2" required></textarea>
        </div>
        <div>
          <label for="name">Supervisor Name:</label>
          <input type="text" name="name" id="name" required>
        </div>
        <!-- Area Name -->
        <div class="full-width">
          <label for="areaDropdown">Area Name:</label>
<select name="area_name" id="areaDropdown" required>
  <option value="">-- Select Area --</option>
  <!-- {% for area in areas %}
    <option value="{{ area.name }}">{{ area.name }}</option>
  {% endfor %} -->
</select>
        </div>    

        <!-- Request Type -->
        <div class="full-width">
          <label>Request Type:</label>
          <div class="checkbox-group">
            <label class="checkbox-item"><input type="checkbox" name="requestType" value="Public Safety"> Public Safety</label>
            <label class="checkbox-item"><input type="checkbox" name="requestType" value="Sanitation / Hygiene"> Sanitation / Hygiene</label>
            <label class="checkbox-item"><input type="checkbox" name="requestType" value="Road / Traffic Issues"> Road / Traffic Issues</label>
            <label class="checkbox-item"><input type="checkbox" name="requestType" value="Electricity / Water Supply"> Electricity / Water Supply</label>
            <label class="checkbox-item"><input type="checkbox" name="requestType" value="Government Services"> Government Services</label>

            <!-- Others -->
            <label class="checkbox-item">
              <input type="checkbox" name="requestType" value="Others">
              Others:
              <input type="text" name="otherType" placeholder="Specify here">
            </label>
          </div>
        </div>

        <button type="submit" class="submit-btn">Submit Request</button>
      </form>

    </div>
</div>


  <script>
    // Complaint modal
    function openComplaintModal(){ document.getElementById('complaintModal').style.display='flex'; }
    function closeComplaintModal(){ document.getElementById('complaintModal').style.display='none'; }

    // Request modal
    function openRequestModal(){ document.getElementById('requestModal').style.display='flex'; }
    function closeRequestModal(){ document.getElementById('requestModal').style.display='none'; }

    // Close modals on outside click
    window.addEventListener('click', function(event){
      const complaintModal = document.getElementById('complaintModal');
      const requestModal = document.getElementById('requestModal');
      if(event.target === complaintModal) complaintModal.style.display='none';
      if(event.target === requestModal) requestModal.style.display='none';
    });
  </script>

</body>
</html>
